#! Directories
##? Project File Dirs
SOURCE_DIR := source
INCLUDE_DIR := include
BIN_DIR := bin

##? MINGW32 Dirs
MINGW_INCLUDE := /usr/i686-w64-mingw32/include
MINGW_LIB := /usr/i686-w64-mingw32/lib

#! Compiler Settings
CXX := i686-w64-mingw32-g++
CXXFLAGS := -ffunction-sections
CXXFLAGS := $(CXXFLAGS) -fmerge-all-constants -fdata-sections -Wno-write-strings 
CXXFLAGS := $(CXXFLAGS) -Wint-to-pointer-cast -fno-exceptions -fno-rtti -fno-stack-protector

#! Linker Settings
LDFLAGS := -mconsole -static-libgcc -static-libstdc++
LDFLAGS := $(LDFLAGS) -I$(MINGW_INCLUDE) -I$(INCLUDE_DIR) -L$(MINGW_LIB)

#! Files
##? Sources
CXX_SRCS := $(wildcard $(SOURCE_DIR)/*.cpp)
##? Headers
CXX_HEADERS := $(wildcard $(INCLUDE_DIR)/*.hpp)

##? Objects
OBJS := $(patsubst $(SOURCE_DIR)/%.cpp, $(BIN_DIR)/%.o, $(CXX_SRCS))

#! Executable
BIN = $(BIN_DIR)/TimeEvasion.exe

.PHONY: all clean

all: $(BIN_DIR) $(BIN)

$(BIN_DIR):
	mkdir $(BIN_DIR)

$(BIN): $(OBJS)
	$(CXX) $(CXXFLAGS) $(LDFLAGS) $< -o $@

$(BIN_DIR)/%.o: $(SOURCE_DIR)/%.cpp
	$(CXX) $(CXXFLAGS) $(LDFLAGS) -c $< -o $@

clean:
	$(RM) -rvf $(BIN_DIR)
